<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Liste des cours</title>

    <!-- STYLE SIMPLE ET LISIBLE (exigence de l'examen) -->
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        h2 {
            margin-bottom: 20px;
        }

        #search {
            padding: 10px;
            width: 100%;
            font-size: 15px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
            border-radius: 6px;
        }

        .cours-card {
            border: 1px solid #ddd;
            padding: 15px;
            margin-bottom: 12px;
            border-radius: 6px;
            background: #f9f9f9;
        }

        .cours-card strong {
            color: #333;
        }
    </style>
</head>
<body>

<h2>Liste des cours</h2>

<!-- BARRE DE RECHERCHE -->
<input type="text" id="search" placeholder="Filtrer les cours..." onkeyup="filterCours()">

<!-- CONTENEUR DES COURS -->
<div id="coursContainer"></div>

<script>
// => IMPORTANT : mets ici l'ID de TON template Cours
const API_URL = "http://localhost/omeka-s/api/items?resource_template_id=2";


async function getCours() {
    try {
        const response = await fetch(API_URL);
        const data = await response.json();
        showCours(data);
    } catch (error) {
        console.error("Erreur API :", error);
    }
}

function showCours(coursList) {
    let container = document.getElementById("coursContainer");
    container.innerHTML = "";

    coursList.forEach(cours => {
        let id = cours["o:id"];
        let titre = cours["dcterms:title"]?.[0]?.["@value"] ?? "Sans titre";
        let description = cours["dcterms:description"]?.[0]?.["@value"] ?? "Aucune description";

        // Cette propriété existe dans ton vocabulaire (mais dans Etudiant)
        let inscrits = cours["mev:inscritDansCours"] ?? [];

        let div = document.createElement("div");
        div.className = "cours-card";
        div.innerHTML = `
            <strong>Identifiant :</strong> ${id}<br>
            <strong>Titre :</strong> ${titre}<br>
            <strong>Étudiants inscrits :</strong> ${inscrits.length}<br>
        `;

        container.appendChild(div);
    });
}


function filterCours() {
    let search = document.getElementById("search").value.toLowerCase();
    let cards = document.querySelectorAll(".cours-card");

    cards.forEach(card => {
        card.style.display = card.innerText.toLowerCase().includes(search)
            ? "block"
            : "none";
    });
}

// Chargement initial
getCours();
</script>

</body>
</html>
